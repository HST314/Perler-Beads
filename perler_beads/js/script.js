/**
 * 拼豆设计助手 - 主要逻辑代码
 * @description 基于HTML5 Canvas的拼豆设计工具
 * @license MIT
 * @copyright 2025 [HST && huangshitong0314@163.com]
 */
const _0x2d6729=_0x1b1e;(function(_0x3807fb,_0x5edf0a){const _0x28f1ce=_0x1b1e,_0x3cae81=_0x3807fb();while(!![]){try{const _0x37680f=-parseInt(_0x28f1ce(0x228))/0x1+parseInt(_0x28f1ce(0x1bf))/0x2+-parseInt(_0x28f1ce(0x20e))/0x3*(-parseInt(_0x28f1ce(0x219))/0x4)+parseInt(_0x28f1ce(0x1be))/0x5+parseInt(_0x28f1ce(0x231))/0x6*(parseInt(_0x28f1ce(0x217))/0x7)+parseInt(_0x28f1ce(0x21b))/0x8+-parseInt(_0x28f1ce(0x254))/0x9*(parseInt(_0x28f1ce(0x272))/0xa);if(_0x37680f===_0x5edf0a)break;else _0x3cae81['push'](_0x3cae81['shift']());}catch(_0x5a30dd){_0x3cae81['push'](_0x3cae81['shift']());}}}(_0x55a8,0xa215b));let currentPalette='mard',currentImage=null,pixelSize=0x14,pixelData=[],colorSum=new Map(),selectedColor=null,selectedPosition=null,designCanvas,designCtx,zoomLevel=0x1,canvasOffsetX=0x0,canvasOffsetY=0x0,isDragging=![],lastMouseX=0x0,lastMouseY=0x0,isReplaceMode=![],totalBeadsCount=0x0;document[_0x2d6729(0x1f9)](_0x2d6729(0x203),function(){const _0x419b0c=_0x2d6729;designCanvas=document['getElementById'](_0x419b0c(0x1db)),designCtx=designCanvas[_0x419b0c(0x274)]('2d'),initializeColorPalette(),bindEvents();});function initializeColorPalette(){const _0x1b6ce6=_0x2d6729,_0x5a0162=document['getElementById'](_0x1b6ce6(0x22e)),_0x1d2eb1=allPalettes[_0x1b6ce6(0x1cb)](currentPalette);_0x5a0162[_0x1b6ce6(0x271)]='',_0x1d2eb1['forEach'](_0x35c231=>{const _0x113d15=_0x1b6ce6,_0x1be2a4=getFontColor(_0x35c231[_0x113d15(0x23d)]),_0x5794e6=document[_0x113d15(0x202)](_0x113d15(0x20b));_0x5794e6[_0x113d15(0x284)]=_0x113d15(0x245),_0x5794e6[_0x113d15(0x25d)][_0x113d15(0x1ea)]='#'+_0x35c231['color'],_0x5794e6['style'][_0x113d15(0x23d)]=_0x1be2a4,_0x5794e6[_0x113d15(0x211)]=_0x35c231['name'],_0x5794e6['title']=_0x35c231[_0x113d15(0x1f2)]+'\x20#'+_0x35c231[_0x113d15(0x23d)],_0x5794e6[_0x113d15(0x221)]['color']=_0x35c231['color'],_0x5794e6[_0x113d15(0x221)][_0x113d15(0x1f2)]=_0x35c231[_0x113d15(0x1f2)],_0x5794e6['addEventListener'](_0x113d15(0x201),function(){const _0x391b87=_0x113d15;document[_0x391b87(0x222)](_0x391b87(0x23b))['forEach'](_0x17935d=>{const _0x470f01=_0x391b87;_0x17935d[_0x470f01(0x1da)][_0x470f01(0x20c)](_0x470f01(0x215));}),this[_0x391b87(0x1da)][_0x391b87(0x27d)](_0x391b87(0x215)),document['getElementById'](_0x391b87(0x1cd))[_0x391b87(0x25d)][_0x391b87(0x1ea)]='#'+_0x35c231[_0x391b87(0x23d)],document[_0x391b87(0x22d)]('targetColorName')[_0x391b87(0x211)]=_0x35c231[_0x391b87(0x1f2)],document[_0x391b87(0x22d)](_0x391b87(0x1f0))['textContent']='#'+_0x35c231['color'],document[_0x391b87(0x22d)]('searchResult')[_0x391b87(0x25d)]['display']=_0x391b87(0x200);}),_0x5a0162[_0x113d15(0x1ff)](_0x5794e6);});}function bindEvents(){const _0x4fc982=_0x2d6729;document[_0x4fc982(0x22d)](_0x4fc982(0x216))[_0x4fc982(0x1f9)]('change',function(_0xcde481){const _0x41c630=_0x4fc982;if(_0xcde481[_0x41c630(0x24b)][_0x41c630(0x1d7)][_0x41c630(0x256)]<=0x0)return;document['getElementById'](_0x41c630(0x26f))['textContent']=_0xcde481[_0x41c630(0x24b)][_0x41c630(0x1d7)][0x0][_0x41c630(0x1f2)],handleImageFile(_0xcde481[_0x41c630(0x24b)][_0x41c630(0x1d7)][0x0]);});const _0x32c94d=document[_0x4fc982(0x22d)](_0x4fc982(0x235));['dragenter','dragover','dragleave',_0x4fc982(0x223)][_0x4fc982(0x1d6)](_0x4d0c63=>{const _0x1015fd=_0x4fc982;_0x32c94d[_0x1015fd(0x1f9)](_0x4d0c63,_0x5c0ac9,![]);});function _0x5c0ac9(_0x1b679e){const _0x22d86b=_0x4fc982;_0x1b679e[_0x22d86b(0x22f)](),_0x1b679e[_0x22d86b(0x1f7)]();}[_0x4fc982(0x263),'dragover'][_0x4fc982(0x1d6)](_0x1f5cd3=>{_0x32c94d['addEventListener'](_0x1f5cd3,_0x437217,![]);}),['dragleave',_0x4fc982(0x223)][_0x4fc982(0x1d6)](_0x26c936=>{const _0x51dd9b=_0x4fc982;_0x32c94d[_0x51dd9b(0x1f9)](_0x26c936,_0x46bcd9,![]);});function _0x437217(){const _0x31a1a7=_0x4fc982;_0x32c94d[_0x31a1a7(0x1da)]['add'](_0x31a1a7(0x1c2));}function _0x46bcd9(){const _0x747a80=_0x4fc982;_0x32c94d[_0x747a80(0x1da)][_0x747a80(0x20c)](_0x747a80(0x1c2));}_0x32c94d['addEventListener'](_0x4fc982(0x223),function(_0x6bd4e9){const _0x59a35c=_0x4fc982,_0x2eadef=_0x6bd4e9['dataTransfer'],_0x55e44b=_0x2eadef[_0x59a35c(0x1d7)];_0x55e44b[_0x59a35c(0x256)]&&(document[_0x59a35c(0x22d)](_0x59a35c(0x26f))[_0x59a35c(0x211)]=_0x55e44b[0x0][_0x59a35c(0x1f2)],handleImageFile(_0x55e44b[0x0]));}),_0x32c94d['addEventListener'](_0x4fc982(0x201),function(){const _0xf7dfda=_0x4fc982;document[_0xf7dfda(0x22d)]('imageUpload')[_0xf7dfda(0x201)]();}),document[_0x4fc982(0x22d)](_0x4fc982(0x278))[_0x4fc982(0x1f9)](_0x4fc982(0x204),function(){const _0x4b4641=_0x4fc982;currentPalette=this[_0x4b4641(0x236)],initializeColorPalette(),currentImage&&processImage(currentImage);}),document[_0x4fc982(0x22d)]('pixelSizeSelect')[_0x4fc982(0x1f9)]('change',function(){const _0x22cd0a=_0x4fc982;pixelSize=parseInt(this[_0x22cd0a(0x236)]),currentImage&&processImage(currentImage);}),document[_0x4fc982(0x22d)]('beadPrice')[_0x4fc982(0x1f9)](_0x4fc982(0x252),function(){updateCostEstimation();}),document[_0x4fc982(0x22d)](_0x4fc982(0x22c))[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x233757=_0x4fc982;isReplaceMode=!isReplaceMode,isReplaceMode?(this[_0x233757(0x1da)][_0x233757(0x27d)](_0x233757(0x22a)),document[_0x233757(0x22d)](_0x233757(0x1e6))['textContent']='颜色替换模式已激活\x20-\x20点击设计区域选择要替换的像素'):(this[_0x233757(0x1da)][_0x233757(0x20c)](_0x233757(0x22a)),document['getElementById']('canvasInfo')[_0x233757(0x211)]=_0x233757(0x26d));}),document[_0x4fc982(0x22d)]('exportBtn')[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x1427ee=_0x4fc982,_0x592ffe=new bootstrap[(_0x1427ee(0x23c))](document[_0x1427ee(0x22d)]('exportModal'));_0x592ffe['show']();}),document[_0x4fc982(0x22d)](_0x4fc982(0x261))[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x3fd587=_0x4fc982;pixelData[_0x3fd587(0x256)]>0x0?exportImage():alert(_0x3fd587(0x253)),bootstrap[_0x3fd587(0x23c)][_0x3fd587(0x214)](document[_0x3fd587(0x22d)](_0x3fd587(0x20a)))[_0x3fd587(0x279)]();}),document[_0x4fc982(0x22d)](_0x4fc982(0x1d1))[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x4cfef3=_0x4fc982;colorSum[_0x4cfef3(0x285)]>0x0?exportMaterialList(_0x4cfef3(0x25a)):alert(_0x4cfef3(0x253)),bootstrap[_0x4cfef3(0x23c)]['getInstance'](document[_0x4cfef3(0x22d)](_0x4cfef3(0x20a)))[_0x4cfef3(0x279)]();}),document[_0x4fc982(0x22d)](_0x4fc982(0x1d0))[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x3c76b6=_0x4fc982;colorSum[_0x3c76b6(0x285)]>0x0?exportMaterialList(_0x3c76b6(0x210)):alert(_0x3c76b6(0x253)),bootstrap[_0x3c76b6(0x23c)]['getInstance'](document[_0x3c76b6(0x22d)](_0x3c76b6(0x20a)))[_0x3c76b6(0x279)]();}),document['getElementById']('saveProjectModal')[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x363587=_0x4fc982;alert(_0x363587(0x20f)),bootstrap[_0x363587(0x23c)][_0x363587(0x214)](document[_0x363587(0x22d)](_0x363587(0x20a)))[_0x363587(0x279)]();}),document[_0x4fc982(0x22d)](_0x4fc982(0x1ce))[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x531a61=_0x4fc982;alert(_0x531a61(0x240)),bootstrap[_0x531a61(0x23c)][_0x531a61(0x214)](document[_0x531a61(0x22d)]('exportModal'))[_0x531a61(0x279)]();}),document[_0x4fc982(0x22d)](_0x4fc982(0x212))['addEventListener'](_0x4fc982(0x201),function(){const _0x268857=_0x4fc982;if(!selectedColor){alert(_0x268857(0x1ed));return;}const _0x93e985=document[_0x268857(0x270)](_0x268857(0x1d9));if(!_0x93e985){alert(_0x268857(0x255));return;}const _0x46f5fc=_0x93e985[_0x268857(0x221)][_0x268857(0x23d)];replaceAllColor(selectedColor,_0x46f5fc),updateDesignStats(),updateMaterialList(),bootstrap['Modal'][_0x268857(0x214)](document['getElementById'](_0x268857(0x227)))[_0x268857(0x279)]();}),document[_0x4fc982(0x22d)](_0x4fc982(0x266))[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(){const _0x3572c8=_0x4fc982;if(!selectedPosition){alert(_0x3572c8(0x1ed));return;}const _0x4320ff=document[_0x3572c8(0x270)]('.color-block.selected');if(!_0x4320ff){alert(_0x3572c8(0x255));return;}const _0x56a3f7=_0x4320ff[_0x3572c8(0x221)][_0x3572c8(0x23d)];replacePixelColor(selectedPosition['x'],selectedPosition['y'],_0x56a3f7),updateDesignStats(),updateMaterialList(),bootstrap[_0x3572c8(0x23c)]['getInstance'](document[_0x3572c8(0x22d)](_0x3572c8(0x227)))['hide']();}),document[_0x4fc982(0x22d)](_0x4fc982(0x21c))[_0x4fc982(0x1f9)](_0x4fc982(0x252),function(){const _0x5b91cf=_0x4fc982,_0x452ba5=this[_0x5b91cf(0x236)]['trim']()[_0x5b91cf(0x281)]();if(!_0x452ba5){document['getElementById'](_0x5b91cf(0x1d5))[_0x5b91cf(0x25d)][_0x5b91cf(0x208)]=_0x5b91cf(0x200);return;}const _0x5355b8=allPalettes['get'](currentPalette),_0x25dc67=_0x5355b8['filter'](_0x1c3d54=>_0x1c3d54[_0x5b91cf(0x1f2)][_0x5b91cf(0x281)]()[_0x5b91cf(0x24a)](_0x452ba5)),_0x273fdb=document['getElementById']('searchResult');if(_0x25dc67[_0x5b91cf(0x256)]===0x0)_0x273fdb['innerHTML']=_0x5b91cf(0x1d8),_0x273fdb[_0x5b91cf(0x25d)][_0x5b91cf(0x208)]=_0x5b91cf(0x213);else{const _0x5aa657=_0x25dc67[0x0];document['querySelectorAll'](_0x5b91cf(0x23b))[_0x5b91cf(0x1d6)](_0x505bc6=>{const _0x142d6b=_0x5b91cf;_0x505bc6[_0x142d6b(0x1da)][_0x142d6b(0x20c)](_0x142d6b(0x215));});const _0x574fd9=document[_0x5b91cf(0x270)](_0x5b91cf(0x1fb)+_0x5aa657[_0x5b91cf(0x23d)]+'\x22]');_0x574fd9&&(_0x574fd9[_0x5b91cf(0x1da)][_0x5b91cf(0x27d)](_0x5b91cf(0x215)),_0x574fd9[_0x5b91cf(0x1dc)]({'behavior':_0x5b91cf(0x1c5),'block':'nearest'}),document['getElementById'](_0x5b91cf(0x1cd))[_0x5b91cf(0x25d)]['backgroundColor']='#'+_0x5aa657[_0x5b91cf(0x23d)],document['getElementById'](_0x5b91cf(0x1c9))[_0x5b91cf(0x211)]=_0x5aa657[_0x5b91cf(0x1f2)],document[_0x5b91cf(0x22d)](_0x5b91cf(0x1f0))[_0x5b91cf(0x211)]='#'+_0x5aa657[_0x5b91cf(0x23d)]),_0x273fdb[_0x5b91cf(0x271)]='<div\x20class=\x22text-success\x22>找到\x20'+_0x25dc67[_0x5b91cf(0x256)]+_0x5b91cf(0x218),_0x273fdb[_0x5b91cf(0x25d)][_0x5b91cf(0x208)]=_0x5b91cf(0x213);}}),document[_0x4fc982(0x22d)](_0x4fc982(0x209))[_0x4fc982(0x1f9)]('click',function(){const _0x14965e=_0x4fc982;zoomLevel=Math[_0x14965e(0x1c7)](zoomLevel*1.2,0x5),renderPixelCanvas();}),document[_0x4fc982(0x22d)]('zoomOut')[_0x4fc982(0x1f9)]('click',function(){const _0x401e18=_0x4fc982;zoomLevel=Math[_0x401e18(0x1e5)](zoomLevel/1.2,0.2),renderPixelCanvas();}),document[_0x4fc982(0x22d)](_0x4fc982(0x1ec))[_0x4fc982(0x1f9)]('click',function(){zoomLevel=0x1,canvasOffsetX=0x0,canvasOffsetY=0x0,renderPixelCanvas();}),designCanvas[_0x4fc982(0x1f9)](_0x4fc982(0x201),function(_0x4b30c3){const _0x52dd63=_0x4fc982;if(pixelData[_0x52dd63(0x256)]===0x0)return;if(!isReplaceMode)return;const _0x4340b9=designCanvas[_0x52dd63(0x260)](),_0x402794=designCanvas[_0x52dd63(0x1e0)]/_0x4340b9[_0x52dd63(0x1e0)],_0x73f54a=designCanvas[_0x52dd63(0x1e1)]/_0x4340b9[_0x52dd63(0x1e1)],_0x4e688d=(pixelData[0x0]['length']+0x2)*pixelSize*zoomLevel,_0x409990=(pixelData[_0x52dd63(0x256)]+0x2)*pixelSize*zoomLevel,_0x800765=Math['max'](0x0,(designCanvas['width']-_0x4e688d)/0x2)+canvasOffsetX,_0x3dba56=Math[_0x52dd63(0x1e5)](0x0,(designCanvas[_0x52dd63(0x1e1)]-_0x409990)/0x2)+canvasOffsetY,_0x17310d=(_0x4b30c3['clientX']-_0x4340b9[_0x52dd63(0x1dd)])*_0x402794,_0x133f74=(_0x4b30c3['clientY']-_0x4340b9[_0x52dd63(0x27a)])*_0x73f54a,_0x41b768=Math['floor']((_0x17310d-_0x800765)/(pixelSize*zoomLevel))-0x1,_0x169bf6=Math['floor']((_0x133f74-_0x3dba56)/(pixelSize*zoomLevel))-0x1;if(_0x41b768>=0x0&&_0x41b768<pixelData[0x0][_0x52dd63(0x256)]&&_0x169bf6>=0x0&&_0x169bf6<pixelData[_0x52dd63(0x256)]){const _0x238ffb=pixelData[_0x169bf6][_0x41b768];if(_0x238ffb){selectedPosition={'x':_0x41b768,'y':_0x169bf6},selectedColor=_0x238ffb[_0x52dd63(0x23d)],document['getElementById'](_0x52dd63(0x1f8))[_0x52dd63(0x25d)][_0x52dd63(0x1ea)]='#'+_0x238ffb['color'],document[_0x52dd63(0x22d)](_0x52dd63(0x280))['textContent']='#'+_0x238ffb[_0x52dd63(0x23d)],document[_0x52dd63(0x22d)](_0x52dd63(0x1fd))[_0x52dd63(0x211)]=_0x238ffb[_0x52dd63(0x1f2)];const _0x4e5805=new bootstrap[(_0x52dd63(0x23c))](document[_0x52dd63(0x22d)]('colorReplaceModal'));_0x4e5805[_0x52dd63(0x1e2)](),renderPixelCanvas();}}}),designCanvas[_0x4fc982(0x1f9)](_0x4fc982(0x27b),function(_0x19c68d){const _0x431b88=_0x4fc982;if(isReplaceMode)return;isDragging=!![],lastMouseX=_0x19c68d['clientX'],lastMouseY=_0x19c68d[_0x431b88(0x275)],designCanvas[_0x431b88(0x25d)][_0x431b88(0x241)]='grabbing';}),document[_0x4fc982(0x1f9)](_0x4fc982(0x246),function(_0x251f5e){const _0x41bf0e=_0x4fc982;if(!isDragging)return;const _0x32e295=_0x251f5e[_0x41bf0e(0x1ee)]-lastMouseX,_0xdd7df8=_0x251f5e[_0x41bf0e(0x275)]-lastMouseY;canvasOffsetX+=_0x32e295,canvasOffsetY+=_0xdd7df8,lastMouseX=_0x251f5e[_0x41bf0e(0x1ee)],lastMouseY=_0x251f5e['clientY'],renderPixelCanvas();}),document['addEventListener'](_0x4fc982(0x244),function(){const _0x37123e=_0x4fc982;isDragging=![],designCanvas[_0x37123e(0x25d)][_0x37123e(0x241)]=_0x37123e(0x242);});}function handleImageFile(_0x250c1e){const _0x47edfd=_0x2d6729,_0x5ca785=new FileReader();_0x5ca785[_0x47edfd(0x276)]=function(_0x5c2e01){const _0x2f78c9=_0x47edfd,_0x1263bf=new Image();_0x1263bf[_0x2f78c9(0x1c0)]=_0x5c2e01[_0x2f78c9(0x24b)][_0x2f78c9(0x230)],_0x1263bf[_0x2f78c9(0x276)]=function(){const _0x25d9aa=_0x2f78c9;if(this['width']>0x1f4||this[_0x25d9aa(0x1e1)]>0x1f4){alert(_0x25d9aa(0x20d)+this['width']+'×'+this[_0x25d9aa(0x1e1)]+_0x25d9aa(0x25b));return;}document[_0x25d9aa(0x22d)](_0x25d9aa(0x26a))['style'][_0x25d9aa(0x208)]=_0x25d9aa(0x24e),document[_0x25d9aa(0x22d)]('canvasInfo')['textContent']='处理中...',setTimeout(()=>{const _0x46d293=_0x25d9aa;currentImage=_0x1263bf,processImage(_0x1263bf),document[_0x46d293(0x22d)]('canvasLoading')[_0x46d293(0x25d)][_0x46d293(0x208)]=_0x46d293(0x200);},0x64);};},_0x5ca785[_0x47edfd(0x1df)](_0x250c1e);}function processImage(_0x42a684){const _0xda5d66=_0x2d6729,_0x1f30ed=_0x42a684[_0xda5d66(0x1e0)],_0x30b93e=_0x42a684[_0xda5d66(0x1e1)],_0x4a4e4c=document[_0xda5d66(0x202)](_0xda5d66(0x1de)),_0x13297e=_0x4a4e4c[_0xda5d66(0x274)]('2d');_0x4a4e4c[_0xda5d66(0x1e0)]=_0x1f30ed,_0x4a4e4c['height']=_0x30b93e,_0x13297e[_0xda5d66(0x238)](_0x42a684,0x0,0x0,_0x1f30ed,_0x30b93e);const _0x5a8dc1=_0x13297e[_0xda5d66(0x21f)](0x0,0x0,_0x1f30ed,_0x30b93e),_0x37c0fb=allPalettes[_0xda5d66(0x1cb)](currentPalette),_0xe2d913=generatePaletteMap(_0x37c0fb);colorSum=new Map(),pixelData=new Array(_0x30b93e);for(let _0x8927ff=0x0;_0x8927ff<_0x30b93e;_0x8927ff++){pixelData[_0x8927ff]=new Array(_0x1f30ed);}for(let _0x734b2f=0x0;_0x734b2f<_0x30b93e;_0x734b2f++){for(let _0x2f3543=0x0;_0x2f3543<_0x1f30ed;_0x2f3543++){const _0x26a232=(_0x734b2f*_0x1f30ed+_0x2f3543)*0x4,_0x2ab6c0=_0x5a8dc1['data'][_0x26a232],_0x401fe6=_0x5a8dc1[_0xda5d66(0x205)][_0x26a232+0x1],_0x3bb7bd=_0x5a8dc1[_0xda5d66(0x205)][_0x26a232+0x2],_0x4a0ba5=_0x5a8dc1['data'][_0x26a232+0x3];if(_0x4a0ba5<0x80)continue;const _0x5b5eb8=findSimilarColor(_0x2ab6c0,_0x401fe6,_0x3bb7bd,_0xe2d913),_0x496a84=rgbToHex(_0x5b5eb8['r'],_0x5b5eb8['g'],_0x5b5eb8['b']);colorSum[_0xda5d66(0x259)](_0x496a84)?colorSum[_0xda5d66(0x268)](_0x496a84,colorSum['get'](_0x496a84)+0x1):colorSum[_0xda5d66(0x268)](_0x496a84,0x1),pixelData[_0x734b2f][_0x2f3543]={'color':_0x496a84,'name':_0x5b5eb8[_0xda5d66(0x1f2)],'fontColor':getFontColor(_0x496a84)};}}totalBeadsCount=_0x1f30ed*_0x30b93e,renderPixelCanvas(),updateDesignStats(_0x1f30ed,_0x30b93e),updateMaterialList(),document[_0xda5d66(0x22d)]('canvasInfo')[_0xda5d66(0x211)]=_0xda5d66(0x229)+_0x1f30ed+_0xda5d66(0x1d4)+_0x30b93e+'\x20|\x20总像素:\x20'+_0x1f30ed*_0x30b93e+_0xda5d66(0x22b)+colorSum[_0xda5d66(0x285)];}function renderPixelCanvas(){const _0x213a92=_0x2d6729;if(pixelData[_0x213a92(0x256)]===0x0)return;const _0x1a2740=pixelData[0x0][_0x213a92(0x256)],_0x4a410d=pixelData[_0x213a92(0x256)],_0x320c83=document[_0x213a92(0x270)]('.canvas-container');designCanvas['width']=_0x320c83[_0x213a92(0x25e)],designCanvas[_0x213a92(0x1e1)]=_0x320c83[_0x213a92(0x1f3)],designCtx[_0x213a92(0x258)](0x0,0x0,designCanvas[_0x213a92(0x1e0)],designCanvas[_0x213a92(0x1e1)]);const _0xefbc3e=Math['min']((_0x1a2740+0x2)*pixelSize*zoomLevel,designCanvas[_0x213a92(0x1e0)]),_0x51feba=Math[_0x213a92(0x1c7)]((_0x4a410d+0x2)*pixelSize*zoomLevel,designCanvas[_0x213a92(0x1e1)]),_0x1404f2=Math[_0x213a92(0x1e5)](0x0,(designCanvas[_0x213a92(0x1e0)]-_0xefbc3e)/0x2)+canvasOffsetX,_0xb073e1=Math['max'](0x0,(designCanvas['height']-_0x51feba)/0x2)+canvasOffsetY;for(let _0x217a15=-0x1;_0x217a15<=_0x4a410d;_0x217a15++){for(let _0x4e0feb=-0x1;_0x4e0feb<=_0x1a2740;_0x4e0feb++){const _0x4f63a4=_0x1404f2+(_0x4e0feb+0x1)*pixelSize*zoomLevel,_0x365b5c=_0xb073e1+(_0x217a15+0x1)*pixelSize*zoomLevel;if(_0x4f63a4+pixelSize*zoomLevel<0x0||_0x4f63a4>designCanvas[_0x213a92(0x1e0)]||_0x365b5c+pixelSize*zoomLevel<0x0||_0x365b5c>designCanvas[_0x213a92(0x1e1)])continue;let _0x20ea2d=null,_0x3b7676=![],_0x45c239='';if(_0x4e0feb===-0x1||_0x4e0feb===_0x1a2740||_0x217a15===-0x1||_0x217a15===_0x4a410d){_0x3b7676=!![];if(_0x4e0feb===-0x1&&_0x217a15>=0x0&&_0x217a15<_0x4a410d)_0x45c239=(_0x217a15+0x1)['toString']();else{if(_0x4e0feb===_0x1a2740&&_0x217a15>=0x0&&_0x217a15<_0x4a410d)_0x45c239=(_0x217a15+0x1)[_0x213a92(0x248)]();else{if(_0x217a15===-0x1&&_0x4e0feb>=0x0&&_0x4e0feb<_0x1a2740)_0x45c239=(_0x4e0feb+0x1)['toString']();else _0x217a15===_0x4a410d&&_0x4e0feb>=0x0&&_0x4e0feb<_0x1a2740&&(_0x45c239=(_0x4e0feb+0x1)[_0x213a92(0x248)]());}}designCtx[_0x213a92(0x23f)]='#f5f5f5',designCtx[_0x213a92(0x250)](_0x4f63a4,_0x365b5c,pixelSize*zoomLevel,pixelSize*zoomLevel),designCtx[_0x213a92(0x27c)]='#ddd',designCtx[_0x213a92(0x249)]=0.5,designCtx[_0x213a92(0x1f5)](_0x4f63a4,_0x365b5c,pixelSize*zoomLevel,pixelSize*zoomLevel),_0x45c239&&(designCtx[_0x213a92(0x23f)]=_0x213a92(0x243),designCtx[_0x213a92(0x206)]=Math[_0x213a92(0x1e5)](0x8,pixelSize*zoomLevel/0x2)+_0x213a92(0x1c6),designCtx['textAlign']=_0x213a92(0x283),designCtx[_0x213a92(0x1f4)]=_0x213a92(0x1ef),designCtx[_0x213a92(0x282)](_0x45c239,_0x4f63a4+pixelSize*zoomLevel/0x2,_0x365b5c+pixelSize*zoomLevel/0x2));}else{_0x20ea2d=pixelData[_0x217a15][_0x4e0feb];if(!_0x20ea2d)continue;designCtx[_0x213a92(0x23f)]='#'+_0x20ea2d[_0x213a92(0x23d)],designCtx[_0x213a92(0x250)](_0x4f63a4,_0x365b5c,pixelSize*zoomLevel,pixelSize*zoomLevel),designCtx[_0x213a92(0x27c)]=_0x213a92(0x1d3),designCtx['lineWidth']=0.5,designCtx[_0x213a92(0x1f5)](_0x4f63a4,_0x365b5c,pixelSize*zoomLevel,pixelSize*zoomLevel),zoomLevel>=0.8&&(designCtx[_0x213a92(0x23f)]=_0x20ea2d[_0x213a92(0x207)],designCtx[_0x213a92(0x206)]=Math['max'](0x8,pixelSize*zoomLevel/0x2)+_0x213a92(0x1c6),designCtx[_0x213a92(0x237)]=_0x213a92(0x283),designCtx['textBaseline']=_0x213a92(0x1ef),designCtx[_0x213a92(0x282)](_0x20ea2d['name'],_0x4f63a4+pixelSize*zoomLevel/0x2,_0x365b5c+pixelSize*zoomLevel/0x2)),selectedPosition&&selectedPosition['x']===_0x4e0feb&&selectedPosition['y']===_0x217a15&&(designCtx['strokeStyle']=_0x213a92(0x21e),designCtx[_0x213a92(0x249)]=0x2,designCtx[_0x213a92(0x1f5)](_0x4f63a4,_0x365b5c,pixelSize*zoomLevel,pixelSize*zoomLevel));}}}}function replaceAllColor(_0x46c157,_0x4d38bc){const _0x2780a8=_0x2d6729,_0x2e3b2c=allPalettes[_0x2780a8(0x1cb)](currentPalette),_0x2b3b50=_0x2e3b2c['find'](_0x1a981d=>_0x1a981d['color']===_0x4d38bc);if(!_0x2b3b50)return;let _0xb764ad=0x0;for(let _0x817af5=0x0;_0x817af5<pixelData[_0x2780a8(0x256)];_0x817af5++){for(let _0x20fc88=0x0;_0x20fc88<pixelData[_0x817af5][_0x2780a8(0x256)];_0x20fc88++){pixelData[_0x817af5][_0x20fc88]&&pixelData[_0x817af5][_0x20fc88][_0x2780a8(0x23d)]===_0x46c157&&(pixelData[_0x817af5][_0x20fc88]={'color':_0x4d38bc,'name':_0x2b3b50['name'],'fontColor':getFontColor(_0x4d38bc)},_0xb764ad++);}}renderPixelCanvas(),updateColorStats(),document[_0x2780a8(0x22d)]('canvasInfo')['textContent']=_0x2780a8(0x26b)+_0xb764ad+_0x2780a8(0x23a);}function _0x1b1e(_0x1c88b6,_0x5f10bd){const _0x55a878=_0x55a8();return _0x1b1e=function(_0x1b1e58,_0x45438c){_0x1b1e58=_0x1b1e58-0x1be;let _0x5e2adf=_0x55a878[_0x1b1e58];return _0x5e2adf;},_0x1b1e(_0x1c88b6,_0x5f10bd);}function replacePixelColor(_0x317c1c,_0x521347,_0x4a576c){const _0x8c487d=_0x2d6729,_0x418a73=allPalettes['get'](currentPalette),_0x51b8a5=_0x418a73[_0x8c487d(0x24d)](_0x1de0d2=>_0x1de0d2['color']===_0x4a576c);if(!_0x51b8a5)return;pixelData[_0x521347][_0x317c1c]={'color':_0x4a576c,'name':_0x51b8a5[_0x8c487d(0x1f2)],'fontColor':getFontColor(_0x4a576c)},renderPixelCanvas(),updateColorStats(),document[_0x8c487d(0x22d)](_0x8c487d(0x1e6))[_0x8c487d(0x211)]=_0x8c487d(0x26c);}function updateColorStats(){const _0x513c3a=_0x2d6729;colorSum=new Map();for(let _0x3a9461=0x0;_0x3a9461<pixelData['length'];_0x3a9461++){for(let _0x190170=0x0;_0x190170<pixelData[_0x3a9461]['length'];_0x190170++){if(pixelData[_0x3a9461][_0x190170]){const _0x32ee8a=pixelData[_0x3a9461][_0x190170][_0x513c3a(0x23d)];colorSum[_0x513c3a(0x259)](_0x32ee8a)?colorSum['set'](_0x32ee8a,colorSum['get'](_0x32ee8a)+0x1):colorSum[_0x513c3a(0x268)](_0x32ee8a,0x1);}}}}function updateDesignStats(_0x5baad5,_0xb9cedd){const _0x457b05=_0x2d6729;(_0x5baad5===undefined||_0xb9cedd===undefined)&&(pixelData[_0x457b05(0x256)]===0x0?(_0x5baad5=0x0,_0xb9cedd=0x0):(_0x5baad5=pixelData[0x0][_0x457b05(0x256)],_0xb9cedd=pixelData[_0x457b05(0x256)])),document[_0x457b05(0x22d)](_0x457b05(0x257))[_0x457b05(0x211)]=_0x5baad5+_0x457b05(0x1d4)+_0xb9cedd,document[_0x457b05(0x22d)](_0x457b05(0x251))[_0x457b05(0x211)]=totalBeadsCount,document['getElementById'](_0x457b05(0x220))[_0x457b05(0x211)]=colorSum[_0x457b05(0x285)],updateCostEstimation();}function updateCostEstimation(){const _0x1ae068=_0x2d6729,_0x2bd964=parseFloat(document['getElementById'](_0x1ae068(0x1c1))['value'])||0x0,_0x52816d=(totalBeadsCount*_0x2bd964)[_0x1ae068(0x1c4)](0x2);document[_0x1ae068(0x22d)](_0x1ae068(0x24f))[_0x1ae068(0x211)]='¥'+_0x52816d;}function updateMaterialList(){const _0x5b0b79=_0x2d6729,_0x915c8e=document['getElementById']('materialList');_0x915c8e[_0x5b0b79(0x271)]='';if(colorSum[_0x5b0b79(0x285)]===0x0){_0x915c8e[_0x5b0b79(0x271)]=_0x5b0b79(0x1ca);return;}const _0x1d35c1=[...colorSum['entries']()][_0x5b0b79(0x1cc)]((_0x95ef42,_0xe878b4)=>_0xe878b4[0x1]-_0x95ef42[0x1]),_0x1edcab=allPalettes[_0x5b0b79(0x1cb)](currentPalette);_0x1d35c1[_0x5b0b79(0x1d6)](([_0x266bcf,_0x393bd5])=>{const _0x48ff9f=_0x5b0b79,_0x25977f=_0x1edcab[_0x48ff9f(0x24d)](_0x26b0f3=>_0x26b0f3['color']===_0x266bcf),_0x45cde7=_0x25977f?_0x25977f[_0x48ff9f(0x1f2)]:_0x48ff9f(0x1c8),_0x22458f=document['createElement'](_0x48ff9f(0x20b));_0x22458f[_0x48ff9f(0x284)]=_0x48ff9f(0x232),_0x22458f['innerHTML']=_0x48ff9f(0x265)+_0x266bcf+_0x48ff9f(0x21a)+getFontColor(_0x266bcf)+'\x22>'+_0x45cde7+_0x48ff9f(0x1eb)+_0x45cde7+_0x48ff9f(0x233)+_0x393bd5+_0x48ff9f(0x1f1),_0x915c8e[_0x48ff9f(0x1ff)](_0x22458f);});}function exportImage(){const _0x41e5b8=_0x2d6729;if(pixelData[_0x41e5b8(0x256)]===0x0)return;const _0x3bbd98=pixelData[0x0][_0x41e5b8(0x256)],_0x3b06b2=pixelData[_0x41e5b8(0x256)],_0x13e6b1=document[_0x41e5b8(0x202)]('canvas'),_0x1e863f=_0x13e6b1[_0x41e5b8(0x274)]('2d'),_0x4a1b4a=pixelSize;_0x13e6b1[_0x41e5b8(0x1e0)]=_0x3bbd98*pixelSize+0x2*_0x4a1b4a,_0x13e6b1[_0x41e5b8(0x1e1)]=_0x3b06b2*pixelSize+0x2*_0x4a1b4a,_0x1e863f[_0x41e5b8(0x23f)]=_0x41e5b8(0x1e7),_0x1e863f[_0x41e5b8(0x250)](0x0,0x0,_0x13e6b1['width'],_0x13e6b1['height']);const _0x1f3f9c=Math[_0x41e5b8(0x1e5)](0x8,pixelSize/0x2),_0x44d330=Math['max'](0x8,pixelSize/0x2);for(let _0x1521e0=0x0;_0x1521e0<_0x3bbd98;_0x1521e0++){_0x1e863f[_0x41e5b8(0x23f)]=_0x41e5b8(0x234),_0x1e863f[_0x41e5b8(0x250)](_0x4a1b4a+_0x1521e0*pixelSize,0x0,pixelSize,_0x4a1b4a),_0x1e863f['strokeStyle']='#ddd',_0x1e863f[_0x41e5b8(0x1f5)](_0x4a1b4a+_0x1521e0*pixelSize,0x0,pixelSize,_0x4a1b4a),_0x1e863f[_0x41e5b8(0x23f)]='#333',_0x1e863f[_0x41e5b8(0x206)]=_0x1f3f9c+_0x41e5b8(0x1c6),_0x1e863f[_0x41e5b8(0x237)]=_0x41e5b8(0x283),_0x1e863f[_0x41e5b8(0x1f4)]=_0x41e5b8(0x1ef),_0x1e863f[_0x41e5b8(0x282)](_0x1521e0+0x1,_0x4a1b4a+_0x1521e0*pixelSize+pixelSize/0x2,_0x4a1b4a/0x2);}for(let _0x4fd854=0x0;_0x4fd854<_0x3bbd98;_0x4fd854++){_0x1e863f[_0x41e5b8(0x23f)]=_0x41e5b8(0x234),_0x1e863f[_0x41e5b8(0x250)](_0x4a1b4a+_0x4fd854*pixelSize,_0x13e6b1['height']-_0x4a1b4a,pixelSize,_0x4a1b4a),_0x1e863f[_0x41e5b8(0x27c)]=_0x41e5b8(0x277),_0x1e863f[_0x41e5b8(0x1f5)](_0x4a1b4a+_0x4fd854*pixelSize,_0x13e6b1[_0x41e5b8(0x1e1)]-_0x4a1b4a,pixelSize,_0x4a1b4a),_0x1e863f[_0x41e5b8(0x23f)]=_0x41e5b8(0x243),_0x1e863f[_0x41e5b8(0x206)]=_0x1f3f9c+'px\x20Arial',_0x1e863f['textAlign']=_0x41e5b8(0x283),_0x1e863f[_0x41e5b8(0x1f4)]=_0x41e5b8(0x1ef),_0x1e863f[_0x41e5b8(0x282)](_0x4fd854+0x1,_0x4a1b4a+_0x4fd854*pixelSize+pixelSize/0x2,_0x13e6b1[_0x41e5b8(0x1e1)]-_0x4a1b4a/0x2);}for(let _0x5b25de=0x0;_0x5b25de<_0x3b06b2;_0x5b25de++){_0x1e863f['fillStyle']='#f5f5f5',_0x1e863f['fillRect'](0x0,_0x4a1b4a+_0x5b25de*pixelSize,_0x4a1b4a,pixelSize),_0x1e863f[_0x41e5b8(0x27c)]='#ddd',_0x1e863f['strokeRect'](0x0,_0x4a1b4a+_0x5b25de*pixelSize,_0x4a1b4a,pixelSize),_0x1e863f[_0x41e5b8(0x23f)]=_0x41e5b8(0x243),_0x1e863f[_0x41e5b8(0x206)]=_0x1f3f9c+'px\x20Arial',_0x1e863f[_0x41e5b8(0x237)]=_0x41e5b8(0x283),_0x1e863f[_0x41e5b8(0x1f4)]=_0x41e5b8(0x1ef),_0x1e863f[_0x41e5b8(0x224)](),_0x1e863f[_0x41e5b8(0x1f6)](_0x4a1b4a/0x2,_0x4a1b4a+_0x5b25de*pixelSize+pixelSize/0x2),_0x1e863f[_0x41e5b8(0x1e8)](-Math['PI']/0x2),_0x1e863f[_0x41e5b8(0x282)](_0x5b25de+0x1,0x0,0x0),_0x1e863f[_0x41e5b8(0x1fc)]();}for(let _0x157b15=0x0;_0x157b15<_0x3b06b2;_0x157b15++){_0x1e863f[_0x41e5b8(0x23f)]=_0x41e5b8(0x234),_0x1e863f[_0x41e5b8(0x250)](_0x13e6b1['width']-_0x4a1b4a,_0x4a1b4a+_0x157b15*pixelSize,_0x4a1b4a,pixelSize),_0x1e863f[_0x41e5b8(0x27c)]='#ddd',_0x1e863f[_0x41e5b8(0x1f5)](_0x13e6b1['width']-_0x4a1b4a,_0x4a1b4a+_0x157b15*pixelSize,_0x4a1b4a,pixelSize),_0x1e863f[_0x41e5b8(0x23f)]='#333',_0x1e863f['font']=_0x1f3f9c+_0x41e5b8(0x1c6),_0x1e863f[_0x41e5b8(0x237)]=_0x41e5b8(0x283),_0x1e863f[_0x41e5b8(0x1f4)]=_0x41e5b8(0x1ef),_0x1e863f[_0x41e5b8(0x224)](),_0x1e863f['translate'](_0x13e6b1['width']-_0x4a1b4a/0x2,_0x4a1b4a+_0x157b15*pixelSize+pixelSize/0x2),_0x1e863f[_0x41e5b8(0x1e8)](-Math['PI']/0x2),_0x1e863f['fillText'](_0x157b15+0x1,0x0,0x0),_0x1e863f[_0x41e5b8(0x1fc)]();}for(let _0x5c1a1d=0x0;_0x5c1a1d<_0x3b06b2;_0x5c1a1d++){for(let _0x5cb41e=0x0;_0x5cb41e<_0x3bbd98;_0x5cb41e++){const _0x3c38e4=pixelData[_0x5c1a1d][_0x5cb41e];if(!_0x3c38e4)continue;_0x1e863f['fillStyle']='#'+_0x3c38e4[_0x41e5b8(0x23d)],_0x1e863f[_0x41e5b8(0x250)](_0x4a1b4a+_0x5cb41e*pixelSize,_0x4a1b4a+_0x5c1a1d*pixelSize,pixelSize,pixelSize),_0x1e863f['strokeStyle']=_0x41e5b8(0x1d3),_0x1e863f['lineWidth']=0.5,_0x1e863f[_0x41e5b8(0x1f5)](_0x4a1b4a+_0x5cb41e*pixelSize,_0x4a1b4a+_0x5c1a1d*pixelSize,pixelSize,pixelSize),_0x1e863f['fillStyle']=_0x3c38e4[_0x41e5b8(0x207)],_0x1e863f['font']=_0x44d330+_0x41e5b8(0x1c6),_0x1e863f[_0x41e5b8(0x237)]='center',_0x1e863f['textBaseline']=_0x41e5b8(0x1ef),_0x1e863f['fillText'](_0x3c38e4[_0x41e5b8(0x1f2)],_0x4a1b4a+_0x5cb41e*pixelSize+pixelSize/0x2,_0x4a1b4a+_0x5c1a1d*pixelSize+pixelSize/0x2);}}const _0x190b64=document[_0x41e5b8(0x202)]('a');_0x190b64['download']=_0x41e5b8(0x25f),_0x190b64[_0x41e5b8(0x1e9)]=_0x13e6b1['toDataURL']('image/png'),_0x190b64[_0x41e5b8(0x201)]();}function _0x55a8(){const _0x18875b=['\x20×\x20','searchResult','forEach','files','<div\x20class=\x22text-danger\x22>没有找到匹配的颜色</div>','.color-block.selected','classList','designCanvas','scrollIntoView','left','canvas','readAsDataURL','width','height','show','================\x0a','MAX_VALUE','max','canvasInfo','#ffffff','rotate','href','backgroundColor','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','resetView','请先在设计区域选择一个像素点','clientX','middle','targetColorHex','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','name','clientHeight','textBaseline','strokeRect','translate','stopPropagation','sourceColor','addEventListener','拼豆物料清单\x0a','.color-block[data-color=\x22','restore','sourceColorName','exec','appendChild','none','click','createElement','DOMContentLoaded','change','data','font','fontColor','display','zoomIn','exportModal','div','remove','图片尺寸过大\x20(','453027kiuwCk','项目保存功能待实现','txt','textContent','replaceAll','block','getInstance','selected','imageUpload','24052DmbtpS','\x20个匹配颜色</div>','28ZWDgBS',';\x20color:\x20','7652248PvRXCo','colorSearch','材料名\x09数量\x0a','#000000','getImageData','colorCount','dataset','querySelectorAll','drop','save','entries','pow','colorReplaceModal','1229131Rxvjua','设计尺寸:\x20','replace-mode-active','\x20|\x20使用颜色:\x20','colorReplaceBtn','getElementById','colorPalette','preventDefault','result','1326gZSuhs','stats-item','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','#f5f5f5','dropArea','value','textAlign','drawImage','材料名,数量\x0a','\x20个像素','.color-block','Modal','color','revokeObjectURL','fillStyle','项目加载功能待实现','cursor','default','#333','mouseup','color-block','mousemove','download','toString','lineWidth','includes','target','物料清单.csv','find','flex','estimatedCost','fillRect','totalBeads','input','请先上传并处理图片','369zGZAJZ','请先在调色板中选择一个替换颜色','length','designSize','clearRect','has','csv',')，请上传500x500像素以内的图片','----------------\x0a','style','clientWidth','拼豆设计.png','getBoundingClientRect','exportImageModal','substring','dragenter','padStart','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22d-flex\x20align-items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22color-block\x20me-2\x22\x20style=\x22background-color:\x20#','replaceSelected','createObjectURL','set','物料清单.txt','canvasLoading','成功替换了\x20','像素颜色已替换','颜色替换模式已关闭','\x20个拼豆\x0a','fileName','querySelector','innerHTML','499650dGpJIf','总计:\x20','getContext','clientY','onload','#ddd','paletteSelect','hide','top','mousedown','strokeStyle','add','text/csv','sqrt','sourceColorHex','toLowerCase','fillText','center','className','size','1137140OtVwYh','1882434PcLbgc','src','beadPrice','dragover','removeChild','toFixed','smooth','px\x20Arial','min','未知颜色','targetColorName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20text-muted\x20py-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22bi\x20bi-info-circle\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22mb-0\x22>上传图片后显示材料清单</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','get','sort','targetColor','loadProjectModal','body','exportMaterialTXTModal','exportMaterialCSVModal','values','#f0f0f0'];_0x55a8=function(){return _0x18875b;};return _0x55a8();}function exportMaterialList(_0x4907ad){const _0x13f8e6=_0x2d6729;if(colorSum[_0x13f8e6(0x285)]===0x0)return;const _0x462b37=allPalettes[_0x13f8e6(0x1cb)](currentPalette),_0x381bf0=[...colorSum[_0x13f8e6(0x225)]()]['sort']((_0x490c51,_0x28845f)=>_0x28845f[0x1]-_0x490c51[0x1]);let _0x1ef686='',_0x30d89b='';_0x4907ad===_0x13f8e6(0x25a)?(_0x1ef686=_0x13f8e6(0x239),_0x381bf0['forEach'](([_0xd01228,_0x10001f])=>{const _0x485c89=_0x462b37['find'](_0x1027e0=>_0x1027e0['color']===_0xd01228),_0x25e898=_0x485c89?_0x485c89['name']:'未知颜色';_0x1ef686+='\x22'+_0x25e898+'\x22,'+_0x10001f+'\x0a';}),_0x30d89b=_0x13f8e6(0x24c)):(_0x1ef686=_0x13f8e6(0x1fa),_0x1ef686+=_0x13f8e6(0x1e3),_0x1ef686+=_0x13f8e6(0x21d),_0x1ef686+=_0x13f8e6(0x25c),_0x381bf0['forEach'](([_0x9bdd61,_0x45de05])=>{const _0x4b228e=_0x13f8e6,_0x19b00b=_0x462b37['find'](_0x3583f0=>_0x3583f0[_0x4b228e(0x23d)]===_0x9bdd61),_0x367abe=_0x19b00b?_0x19b00b[_0x4b228e(0x1f2)]:_0x4b228e(0x1c8);_0x1ef686+=_0x367abe+'\x09'+_0x45de05+'\x0a';}),_0x1ef686+=_0x13f8e6(0x1e3),_0x1ef686+=_0x13f8e6(0x273)+totalBeadsCount+_0x13f8e6(0x26e),_0x30d89b=_0x13f8e6(0x269));const _0x31248a=new Blob([_0x1ef686],{'type':_0x4907ad===_0x13f8e6(0x25a)?_0x13f8e6(0x27e):'text/plain'}),_0x4f7f70=URL[_0x13f8e6(0x267)](_0x31248a),_0x58cb39=document[_0x13f8e6(0x202)]('a');_0x58cb39[_0x13f8e6(0x1e9)]=_0x4f7f70,_0x58cb39[_0x13f8e6(0x247)]=_0x30d89b,document[_0x13f8e6(0x1cf)][_0x13f8e6(0x1ff)](_0x58cb39),_0x58cb39[_0x13f8e6(0x201)](),document[_0x13f8e6(0x1cf)][_0x13f8e6(0x1c3)](_0x58cb39),URL[_0x13f8e6(0x23e)](_0x4f7f70);}function generatePaletteMap(_0x2256fa){const _0xb79e2a=_0x2d6729;let _0x15bfd9=new Map();for(let _0x112c99=0x0;_0x112c99<_0x2256fa['length'];_0x112c99++){let _0x4c42f6=hexToRgb(_0x2256fa[_0x112c99][_0xb79e2a(0x23d)]);_0x15bfd9[_0xb79e2a(0x268)](_0x2256fa[_0x112c99]['color'],{'name':_0x2256fa[_0x112c99]['name'],'r':_0x4c42f6['r'],'g':_0x4c42f6['g'],'b':_0x4c42f6['b']});}return _0x15bfd9;}function findSimilarColor(_0x1e0d47,_0x11fb68,_0x10da20,_0x4febb9){const _0x42f7a1=_0x2d6729;let _0x1217e6=Number[_0x42f7a1(0x1e4)],_0x309509=null;for(let _0x2d436e of _0x4febb9[_0x42f7a1(0x1d2)]()){let _0x29050f=colorDistance(_0x2d436e['r'],_0x2d436e['g'],_0x2d436e['b'],_0x1e0d47,_0x11fb68,_0x10da20);_0x29050f<_0x1217e6&&(_0x1217e6=_0x29050f,_0x309509=_0x2d436e);}return _0x309509;}function colorDistance(_0x4d5b8d,_0x927b7f,_0xb3a4c5,_0x219bc4,_0x25a331,_0x1db305){const _0x525587=_0x2d6729;return Math[_0x525587(0x27f)](Math[_0x525587(0x226)](_0x4d5b8d-_0x219bc4,0x2)+Math[_0x525587(0x226)](_0x927b7f-_0x25a331,0x2)+Math[_0x525587(0x226)](_0xb3a4c5-_0x1db305,0x2));}function hexToRgb(_0x41ba4b){const _0x1bbee6=_0x2d6729;let _0x2adba8=/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i[_0x1bbee6(0x1fe)](_0x41ba4b);return _0x2adba8?{'r':parseInt(_0x2adba8[0x1],0x10),'g':parseInt(_0x2adba8[0x2],0x10),'b':parseInt(_0x2adba8[0x3],0x10)}:null;}function rgbToHex(_0x4585ba,_0x143caf,_0x3aa019){const _0x73895b=_0x2d6729;let _0xa5b9fc=_0x4585ba[_0x73895b(0x248)](0x10)[_0x73895b(0x264)](0x2,'0'),_0x1fa1b9=_0x143caf[_0x73895b(0x248)](0x10)['padStart'](0x2,'0'),_0x337aa9=_0x3aa019[_0x73895b(0x248)](0x10)['padStart'](0x2,'0');return _0xa5b9fc+_0x1fa1b9+_0x337aa9;}function getFontColor(_0x24839b){const _0xd3b64b=_0x2d6729,_0x287221=parseInt(_0x24839b['substring'](0x0,0x2),0x10),_0x44eb5f=parseInt(_0x24839b[_0xd3b64b(0x262)](0x2,0x4),0x10),_0x260399=parseInt(_0x24839b[_0xd3b64b(0x262)](0x4,0x6),0x10),_0x5cad63=(_0x287221*0x12b+_0x44eb5f*0x24b+_0x260399*0x72)/0x3e8;return _0x5cad63>0x80?_0xd3b64b(0x21e):'#FFFFFF';}